{% extends 'base.html' %}

{% block content %}
<body>
  <div class="layui-fluid">
    <div class="layui-row">
      <form class="layui-form" action="/create_task" method="POST">
        <div class="layui-form-item">
          <label for="task_name" class="layui-form-label">任务名称</label>
          <div class="layui-input-inline">
            <input type="text" id="task_name" name="task_name" required lay-verify="task_name" autocomplete="off" class="layui-input">
          </div>
        </div>
        <div class="layui-form-item">
          <label for="targets" class="layui-form-label">目标列表</label>
          <div class="layui-input-inline">
            <textarea id="targets" name="targets" placeholder="xx.com" class="layui-textarea" style="word-wrap:normal;height: 285px;"></textarea>
          </div>
        </div>
        <div class="layui-form-item">
          <label class="layui-form-label">扫描选项</label>
          <div class="layui-input-block">
            <input type="checkbox" name="sensitive_files_scan" value="1" lay-skin="primary" title="敏感文件扫描">
            <input type="checkbox" name="enable_subDomain" value="1" lay-skin="primary" title="子域名爆破">
            <input type="checkbox" name="enable_nuclei" value="1" lay-skin="primary" title="启用nuclei">
            <input type="checkbox" name="enable_afrog" value="1" lay-skin="primary" title="启用afrog">
          </div>
        </div>
        <div class="layui-form-item">
          <label for="real_flag" class="layui-form-label"></label>
          <button class="layui-btn" lay-filter="add" lay-submit>确定添加</button>
        </div>
      </form>
    </div>
  </div>
  <script>
    layui.use(['form', 'layer', 'laydate'], function() {
      var $ = layui.jquery;
      var form = layui.form;
      var layer = layui.layer;
      var laydate = layui.laydate;

      //自定义验证规则
      form.verify({
        task_name:[/\S/, '任务名称不能为空'],
      });

      //监听提交
      form.on('submit(add)', function(data) {
        console.log(data.field);
        $.post(data.form.action, data.field);
        // 发异步，把数据提交给服务端
        layer.alert("增加成功", {icon: 6}, function() {
          //关闭当前frame
          xadmin.close();
          // 可以对父窗口进行刷新
          xadmin.father_reload();
        });
        return false;
      });
    });
  </script>
</body>
{% endblock %}
